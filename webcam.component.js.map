{"version":3,"file":"webcam.component.js","sourceRoot":"","sources":["../src/webcam.component.ts"],"names":[],"mappings":"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","sourcesContent":["//import * as a from './audioTest'\n\nimport { Component, ElementRef, Input, Output, EventEmitter } from '@angular/core'\nimport { DomSanitizer } from '@angular/platform-browser'\nimport {\n  browser,\n  getMedia,\n  Options,\n  dataUriToFormData,\n  videoInputsByDevices,\n  Fallback,\n  //MediaDevice,\n  promiseDevices,\n  promiseDeviceById\n} from \"./videoHelp\"\n\nconst template = `<video id=\"video\" *ngIf=\"(isSupportUserMedia||isSupportWebRTC)\" autoplay=\"\" playsinline=\"\">Video stream not available</video>`\n\nexport interface vidElmOptions{\n  audio: boolean | MediaTrackConstraints\n  video: boolean | MediaTrackConstraints\n}\n\nexport interface elementSets{\n  width:number\n  height:number\n}\n\nexport interface sets{\n  element:elementSets\n}\n\n@Component({\n  selector: 'ack-webcam',\n  template: template\n}) export class WebCamComponent {\n  /* platform support variables */\n    flashPlayer:Fallback\n    isSupportUserMedia: boolean\n    isSupportWebRTC: boolean\n    isFallback: boolean\n  /* end: platform support variables */\n  \n  initComplete:boolean\n  observer:MutationObserver\n  onResize:()=>any\n  stream:MediaStream\n\n  sets:sets = {element:{width:0,height:0}}\n\n  @Input() videoDevice:MediaDeviceInfo\n  @Input() videoDeviceId:string\n  //@Input() audioDeviceId:string\n  \n  @Input() reflect:boolean//mirror camera image\n  @Input() facingMode:\"user\"|\"environment\"|\"left\"|\"right\"|string\n  @Input() mime = 'image/jpeg'\n  @Input() useParentWidthHeight:boolean = false\n  \n  @Input() options: Options\n  @Output() success:EventEmitter<MediaStream> = new EventEmitter()\n\n  //-Lazy @ViewChild() variable reference\n  //@Input() ref:WebCamComponent\n  //@Output() refChange:EventEmitter<WebCamComponent> = new EventEmitter()\n  \n  @Input() error:Error\n  @Output() errorChange:EventEmitter<Error> = new EventEmitter()\n  @Output('catch') catcher:EventEmitter<Error> = new EventEmitter()\n\n  constructor(\n    private sanitizer: DomSanitizer,\n    private element: ElementRef){\n    console.log(\"123\")\n  }\n\n  ngOnInit(){\n    this.isSupportUserMedia = getMedia()!=null ? true : false\n    this.isSupportUserMedia = false\n    this.isSupportWebRTC = !!(browser.mediaDevices && browser.mediaDevices.getUserMedia)\n  }\n\n  ngAfterViewInit(){\n    this.applyDefaults()\n    setTimeout(()=>this.afterInitCycles(), 0)\n  }\n\n  ngOnChanges( changes ) {\n    if( !this.initComplete )return\n\n    if(\n      changes.facingMode\n    || changes.videoDevice\n    || changes.videoDeviceId\n    ){\n      this.redraw()//restart\n    }\n\n    if( changes.reflect ){\n      this.applyReflect()\n    }\n  }\n\n  ngOnDestroy(){\n    this.observer.disconnect()\n    window.removeEventListener('resize', this.onResize)\n    this.stop()\n  }\n\n  play(){\n    return this.redraw()\n  }\n\n  stop(){\n    const vid = this.getVideoElm()\n    if(vid && vid.pause){\n      vid.pause()\n    }\n\n    if( this.stream ){\n      this.stream.getTracks().forEach(track=>track.stop())\n    }\n  }\n\n  redraw(){\n    this.stop()\n    this.startCapturingVideo()\n  }\n\n  afterInitCycles(){\n    const media = getMedia()\n\n    // Older browsers might not implement mediaDevices at all, so we set an empty object first\n    if ((browser.mediaDevices === undefined) && !!media) {\n      browser.mediaDevices = {}\n    }\n\n    // Some browsers partially implement mediaDevices. We can't just assign an object\n    // with getUserMedia as it would overwrite existing properties.\n    // Here, we will just add the getUserMedia property if it's missing.\n    const getUserMediaUndefined = (browser.mediaDevices && browser.mediaDevices.getUserMedia === undefined) && !!media\n    if( getUserMediaUndefined ){\n      browser.mediaDevices.getUserMedia = constraints=>{\n        return new Promise((resolve, reject)=>{\n          const userMedia = media.call(browser, constraints, resolve, reject)\n\n          if( userMedia.then ){\n            userMedia.then( stream=>this.applyStream(stream) )\n          }\n        })\n        .catch( err=>this.catchError(err) )\n      }\n    }\n\n    this.initComplete = true\n    \n    //deprecated. Use angular hash template referencing and @ViewChild\n    //setTimeout(()=>this.refChange.emit(this), 0)\n\n    this.createVideoResizer()\n    \n    this.startCapturingVideo()\n    .then( ()=>setTimeout(()=>this.resize(), 10) )\n    .catch( err=>this.catchError(err) )\n  }\n\n  applyReflect(){\n    const videoElm = this.getVideoElm()\n\n    if(!videoElm)return\n\n    if( this.reflect ){\n      videoElm.style.transform = \"scaleX(-1)\"\n    }else{\n      videoElm.style.transform = \"scaleX(1)\"\n    }\n  }\n\n  applyStream( stream:MediaStream ){\n    const videoElm = this.getVideoElm()\n    videoElm.srcObject = stream\n    this.applyReflect()\n  }\n\n  createVideoResizer(){\n    this.observer = new MutationObserver( ()=>this.resize() )\n    \n    const config = {\n      attributes: true,\n      childList: true,\n      characterData: true\n      //,subtree: true\n    }\n    this.observer.observe(this.element.nativeElement, config)\n\n    this.onResize = ()=>this.resize()\n    window.addEventListener('resize', this.onResize)\n  }\n\n  applyDefaults(){\n    this.options = this.options || <Options>{}\n    this.options.fallbackSrc = this.options.fallbackSrc || 'jscam_canvas_only.swf'\n    this.options.fallbackMode = this.options.fallbackMode || 'callback'\n    this.options.fallbackQuality = this.options.fallbackQuality || 200\n    this.isFallback = this.options.fallback || (!this.isSupportUserMedia && !this.isSupportWebRTC && this.options.fallbackSrc) ? true : false\n\n    if(!this.options.video && !this.options.audio){\n      this.options.video = true\n    }\n  }\n\n  onWebRTC(): Promise<MediaStream> {\n    let promise:Promise<MediaDeviceInfo> = Promise.resolve(null)\n\n    return this.promiseVideoOptions()\n    .then( options=>{\n      this.options.video = options\n      return this.setWebcam(this.options)\n    })\n  }\n\n  promiseVideoOptions():Promise<MediaTrackConstraints>{\n    let promise = Promise.resolve()\n\n    const videoOptions:MediaTrackConstraints = {}\n    \n    if( this.options.video && isOb(this.options.video) ){\n      Object.assign(videoOptions, this.options.video)\n\n      /* attempt to prevent bad videoOptions */\n        if( videoOptions.width && isOb(videoOptions.width) && !Object.keys(videoOptions.width).length ){\n          delete videoOptions.width\n        }\n\n        if( videoOptions.height && isOb(videoOptions.height) && !Object.keys(videoOptions.height).length ){\n          delete videoOptions.height\n        }\n      /* end: fix vid options */\n    }\n\n    if( this.facingMode ){\n      videoOptions.facingMode = this.facingMode//{exact:this.facingMode}\n    }\n\n    if( this.videoDeviceId ){\n      //videoOptions.deviceId = {exact:this.videoDeviceId}\n      videoOptions.deviceId = this.videoDeviceId\n    }else if( this.videoDevice ){\n      //videoOptions.deviceId = {exact:this.videoDevice.deviceId}\n      videoOptions.deviceId = this.videoDevice.deviceId\n    }\n\n    return promise.then( ()=>videoOptions )\n  }\n\n  //old method name (deprecated)\n  resizeVideo(maxAttempts=4){\n    return this.resize(maxAttempts)\n  }\n\n  resize(maxAttempts=4){\n    const video = this.getVideoElm()\n    \n    if(!video)return\n\n    video.style.position='absolute'\n    \n    const elm = this.useParentWidthHeight ? this.element.nativeElement.parentNode : this.element.nativeElement\n\n    let width = this.options.width || parseInt(elm.offsetWidth, 10)\n    let height = this.options.height || parseInt(elm.offsetHeight, 10)\n\n    if(!width || !height){\n      width = 320\n      height = 240\n    }\n\n    setTimeout(()=>{\n      video.width = width\n      video.height = height\n      \n      this.sets.element.width = width\n      this.sets.element.height = height\n      \n      video.style.position='static'\n  \n      //now that we set a width and height, it may need another adjustment if it pushed percent based items around\n      const resizeAgain = (!this.options.width && width!=parseInt(elm.offsetWidth, 10)) || (!this.options.height && height!=parseInt(elm.offsetHeight, 10))\n  \n      if( resizeAgain && maxAttempts){\n        this.resize( --maxAttempts )\n      }\n    }, 1)\n  }\n\n  getVideoDimensions(video){\n    video = video || this.getVideoElm()\n    const dim = {width:0, height:0}\n\n    if( video.videoWidth ){\n      dim.width = video.videoWidth\n      dim.height = video.videoHeight\n    }else{\n      dim.width = this.options.width || parseInt(this.element.nativeElement.offsetWidth, 10)\n      dim.height = this.options.height || parseInt(this.element.nativeElement.offsetHeight, 10)\n    }\n\n    if( !dim.width )dim.width = 320\n    if( !dim.height )dim.height = 240\n\n    return dim\n  }\n\n  getVideoElm(){\n    const native = this.element.nativeElement\n    const elmType = this.isFallback ? 'object' : 'video'\n    return native.getElementsByTagName(elmType)[0]\n  }\n\n  setWebcam(options:Options): Promise<MediaStream> {\n    return this.promiseStreamByVidOptions(options)\n    .then(stream=>{\n      this.applyStream(stream)\n      this.processSuccess(stream)\n      this.stream = stream\n      return stream\n    })\n    .catch( err=>this.catchError(err) )\n  }\n\n  catchError(err:Error):Promise<any>{\n    this.errorChange.emit(this.error=err)\n    this.catcher.emit(err)\n\n    if( !this.errorChange.observers.length && !this.catcher.observers.length ){\n      return Promise.reject(err)//if no error subscriptions promise need to continue to be Uncaught\n    }\n  }\n\n  promiseStreamByVidOptions(\n    optionObject:vidElmOptions\n  ):Promise<MediaStream>{\n    return new Promise((resolve, reject) => {\n      try {\n        browser.mediaDevices.getUserMedia(optionObject)\n        .then(stream=>resolve(stream))\n        .catch((objErr:any)=>reject(objErr))\n      } catch (e) {\n        reject(e)\n      }\n    })\n  }\n\n  processSuccess(stream?){\n    if (this.isFallback) {\n      this.setupFallback()\n    }else{\n      this.success.emit(stream)\n    }\n  }\n\n  /**\n   * Start capturing video stream\n   * @returns {void}\n   */\n  startCapturingVideo(): Promise<any> {\n    if (!this.isFallback && this.isSupportWebRTC) {\n      return this.onWebRTC()\n    }\n\n    return Promise.resolve( this.processSuccess() )\n  }\n\n  getCanvas(){\n    const canvas = document.createElement('canvas')\n    const video = this.getVideoElm()\n    this.setCanvasWidth(canvas, video)\n    const ctx = canvas.getContext('2d')\n\n    if( this.reflect ){\n      ctx.translate(canvas.width, 0);\n      ctx.scale(-1, 1);\n    }\n\n    ctx.drawImage(video, 0, 0)\n    return canvas\n  }\n\n  getBlob():Promise<Blob>{\n    return new Promise((res,rej)=>{\n      const canvas = this.getCanvas()\n      canvas.toBlob(file=>{\n        res(file)\n      }, this.mime, 1)\n    })\n  }\n\n  getFile( fileName:string ):Promise<File>{\n    return this.getBlob().then(file=>blobToFile(file,fileName))\n  }\n\n  /** returns promise . @mime - null=png . Also accepts image/jpeg */\n  getBase64(mime?):Promise<string>{\n    if(this.isFallback){\n      return this.flashPlayer.captureBase64(mime||this.mime)\n      //return this.getFallbackBase64(mime)\n    }else{\n      const canvas = this.getCanvas()\n      return Promise.resolve( canvas.toDataURL(mime) )\n    }\n  }\n\n  setCanvasWidth(canvas, video){\n    const di = this.getVideoDimensions(video)\n    canvas.width = di.width\n    canvas.height = di.height\n  }\n\n  /** older browsers (IE11) cannot dynamically apply most attribute changes to object elements. Use this method during fallback */\n  createVidElmOb(){\n    const rtnElm = document.createElement('object')\n    rtnElm.innerHTML = 'Video stream not available'\n    rtnElm.setAttribute('type','application/x-shockwave-flash')\n    rtnElm.setAttribute('data',this.options.fallbackSrc)\n\n    let paramVar = document.createElement('param')\n    paramVar.setAttribute('name','FlashVars')\n    paramVar.setAttribute('value','mode=callback&amp;quality=200')\n    rtnElm.appendChild( paramVar )\n\n    paramVar = document.createElement('param')\n    paramVar.setAttribute('name','allowScriptAccess')\n    paramVar.setAttribute('value','always')\n    rtnElm.appendChild( paramVar )\n\n    paramVar = document.createElement('param')\n    paramVar.setAttribute('name','movie')\n    paramVar.setAttribute('value',this.options.fallbackSrc)\n    rtnElm.appendChild( paramVar )\n\n    const obs = this.element.nativeElement.getElementsByTagName('object')\n    if(obs.length){\n      this.element.nativeElement.removeChild( obs[0] )\n    }\n\n    this.element.nativeElement.appendChild( rtnElm )\n\n    return rtnElm\n  }\n\n  setupFallback(): void {\n    this.isFallback = true\n    const vidElm = this.getVideoElm() || this.createVidElmOb()\n    this.flashPlayer = new Fallback( vidElm )\n  }\n\n  /** single image to FormData */\n  captureAsFormData(options?:{mime?:string, fileName?:string, form?:FormData}){\n    options = options || {}\n    return this.getBase64(options.mime)\n    .then( base64=>dataUriToFormData(base64, {fileName:options.fileName}) )\n  }\n\n  dataUriToFormData(base64, options){\n    return dataUriToFormData(base64, {fileName:options.fileName})\n  }\n}\n\n\nfunction isOb(v){\n  return typeof(v)==='object'\n}\n\nfunction blobToFile(\n  theBlob: Blob, fileName:string\n ):File{\n    var b: any = theBlob;\n    //A Blob() is almost a File() - it's just missing the two properties below which we will add\n    b.lastModifiedDate = new Date();\n    b.name = fileName;\n\n    //Cast to a File() type\n    return <File>theBlob;\n}\n"]}