{"version":3,"sources":["../lib/webcam.component.ts"],"names":[],"mappings":"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","file":"webcam.component.js","sourceRoot":"","sourcesContent":["import { Component, ElementRef, Input, Output, EventEmitter } from '@angular/core';\nimport { DomSanitizer } from '@angular/platform-browser';\n\nconst template = `\n<video id=\"video\" *ngIf=\"isSupportWebRTC && videoSrc\" [src]=\"videoSrc\" autoplay>Video stream not available</video>\n\n<object *ngIf=\"isFallback\" data=\"jscam_canvas_only.swf\">\n  Video stream not available\n  <param name=\"FlashVars\" value=\"mode=callback&amp;quality=200\">\n  <param name=\"allowScriptAccess\" value=\"always\">\n  <param name=\"movie\" value=\"jscam_canvas_only.swf\">\n</object>\n`\n\n/**\n * Component options structure interface\n */\nexport interface Options {\n  video: boolean | any;\n  cameraType: string;\n  audio: boolean;\n  width: number;\n  height: number;\n  fallback:boolean;\n  fallbackSrc: string;\n  fallbackMode: string;\n  fallbackQuality: number;\n}\n\n/**\n * https://developer.mozilla.org/en-US/docs/Web/API/MediaDevices\n */\nexport interface MediaDevice {\n  deviceId: string;\n  kind: string;\n  label: string;\n}\n\n/**\n * Render WebCam Component\n */\n export class WebCamComponent {\n  public flashPlayer\n  public videoSrc: any;\n  public isSupportWebRTC: boolean;\n  public isFallback: boolean;\n  public browser: any;\n  public observer\n  public onResize\n  public stream\n  \n   public mime='image/jpeg'\n\n   ref\n   refChange = new EventEmitter()\n  \n   options: Options;\n   onSuccess = new EventEmitter()\n   onError = new EventEmitter()\n\n  constructor(private sanitizer: DomSanitizer, private element: ElementRef) {\n    this.isFallback = false;\n    this.isSupportWebRTC = false;\n    this.browser = <any>navigator;\n  }\n\n  ngAfterViewInit() {\n    setTimeout(()=>this.afterInitCycles(), 0)\n  }\n\n  afterInitCycles(){\n    // getUserMedia() feature detection for older browser\n    this.browser.getUserMedia_ = (this.browser.getUserMedia\n    || this.browser.webkitGetUserMedia\n    || this.browser.mozGetUserMedia\n    || this.browser.msGetUserMedia);\n\n    // Older browsers might not implement mediaDevices at all, so we set an empty object first\n    if ((this.browser.mediaDevices === undefined) && !!this.browser.getUserMedia_) {\n      this.browser.mediaDevices = {};\n    }\n\n    // Some browsers partially implement mediaDevices. We can't just assign an object\n    // with getUserMedia as it would overwrite existing properties.\n    // Here, we will just add the getUserMedia property if it's missing.\n    if ((this.browser.mediaDevices && this.browser.mediaDevices.getUserMedia === undefined) && !!this.browser.getUserMedia_) {\n      this.browser.mediaDevices.getUserMedia = (constraints) => {\n        return new Promise((resolve, reject) => {\n          this.browser.getUserMedia_.call(this.browser, constraints, resolve, reject);\n        });\n      }\n    }\n    \n    this.isSupportWebRTC = !!(this.browser.mediaDevices && this.browser.mediaDevices.getUserMedia);\n    this.applyDefaults()\n\n    this.ref = Object.assign(this, this.ref, {\n      element:this.element,\n      options:this.options,\n      onSuccess:this.onSuccess,\n      onError:this.onError\n    })\n    setTimeout(()=>this.refChange.emit(this), 0)\n\n    this.observer = new MutationObserver( ()=>this.resizeVideo() )\n    \n    const config = {\n      attributes: true,\n      childList: true,\n      characterData: true,\n      //subtree: true\n    }\n    this.observer.observe(this.element.nativeElement, config);\n\n    this.onResize = function(){this.resizeVideo()}.bind(this)\n\n    window.addEventListener('resize', this.onResize)\n\n    this.startCapturingVideo();\n\n    this.onResize()\n  }\n\n  applyDefaults(){\n    this.options = this.options || <Options>{}\n    // default options\n    this.options.fallbackSrc = this.options.fallbackSrc || 'jscam_canvas_only.swf';\n    this.options.fallbackMode = this.options.fallbackMode || 'callback';\n    this.options.fallbackQuality = this.options.fallbackQuality || 200;\n    //this.options.width = this.options.width || 320;\n    //this.options.height = this.options.height || 240;\n    this.options.cameraType = this.options.cameraType  || 'front';\n    // flash fallback detection\n    this.isFallback = this.options.fallback || (!this.isSupportWebRTC && !!this.options.fallbackSrc)\n\n    if(!this.options.video && !this.options.audio){\n      this.options.video = true\n    }\n  }\n\n  /**\n   * Switch to facing mode and setup web camera\n   * @returns {void}\n   */\n  onWebRTC(): any {\n    // https://developer.mozilla.org/en-US/docs/Web/API/MediaDevices/enumerateDevices\n    if (this.browser.mediaDevices.enumerateDevices && this.options.video) {\n      const cameraType = this.options.cameraType;\n      this.browser.mediaDevices.enumerateDevices().then((devices) => {\n        devices.forEach((device: MediaDevice) => {\n          if (device && device.kind === 'videoinput') {\n            if (device.label.toLowerCase().search(cameraType) > -1) {\n              this.options.video = {deviceId: {exact: device.deviceId}, facingMode: 'environment'};\n            }\n          }\n        });\n        this.setWebcam();\n      });\n    }\n    else {\n      this.setWebcam();\n    }\n  }\n\n  resizeVideo(){\n    const video = this.getVideoElm();\n    \n    if(!video)return\n\n    video.width = 0;\n    video.height = 0;\n    \n    let width = this.options.width || parseInt(this.element.nativeElement.offsetWidth, 10)\n    let height = this.options.height || parseInt(this.element.nativeElement.offsetHeight, 10)\n\n    if(!width || !height){\n      width = 320\n      height = 240\n    }\n\n    video.width = width\n    video.height = height\n  }\n\n  getVideoDimensions(video){\n    video = video || this.getVideoElm()\n    const dim = {width:0, height:0}\n\n    if(video.videoWidth){\n      dim.width = video.videoWidth\n      dim.height = video.videoHeight\n    }else{\n      dim.width = this.options.width || parseInt(this.element.nativeElement.offsetWidth, 10)\n      dim.height = this.options.height || parseInt(this.element.nativeElement.offsetHeight, 10)\n    }\n\n    if(!dim.width)dim.width = 320\n    if(!dim.height)dim.height = 240\n\n    return dim\n  }\n\n  getVideoElm(){\n    const elmType = this.isFallback ? 'object' : 'video'\n    return this.element.nativeElement.getElementsByTagName(elmType)[0]\n  }\n\n  /**\n   * Setup web camera using native browser API\n   * @returns {void}\n   */\n  setWebcam(): any {\n    // constructing a getUserMedia config-object and\n    // an string (we will try both)\n    let optionObject = { audio: false, video: false };\n    let optionString = '';\n\n    if (this.options.video) {\n      optionObject.video = this.options.video;\n      optionString = 'video';\n    }\n\n    if (this.options.audio === true) {\n      optionObject.audio = true;\n      if (optionString !== '') {\n        optionString = optionString + ', ';\n      }\n      optionString = optionString + 'audio';\n    }\n\n    // Promisify async callback's for angular2 change detection\n    const promisifyGetUserMedia = () => {\n      return new Promise<string>((resolve, reject) => {\n        // first we try if getUserMedia supports the config object\n        try {\n          // try object\n          this.browser.mediaDevices.getUserMedia(optionObject)\n            .then((stream: any) => resolve(stream))\n            .catch((objErr: any) => {\n              // option object fails\n              // try string syntax\n              // if the config object failes, we try a config string\n              this.browser.mediaDevices.getUserMedia(optionObject)\n                .then((stream: any) => resolve(stream))\n                .catch((strErr: any) => {\n\n                  console.error(objErr);\n                  console.error(strErr);\n\n                  reject(new Error('Both configs failed. Neither object nor string works'));\n              });\n          });\n        } catch (e) {\n          reject(e);\n        }\n      });\n    };\n\n    promisifyGetUserMedia().then((stream) => {\n      let webcamUrl = URL.createObjectURL(stream);\n      this.videoSrc = this.sanitizer.bypassSecurityTrustResourceUrl(webcamUrl);\n      this.processSuccess(stream)\n      this.stream = stream\n    }).catch((err) => {\n      this.onError.emit(err);\n    });\n  }\n\n  processSuccess(stream?){\n    if (this.isFallback) {\n      this.setupFallback()\n    }else{\n      this.onSuccess.emit(stream)\n    }\n  }\n\n  /**\n   * Add <param>'s into fallback object\n   * @param cam - Flash web camera instance\n   * @returns {void}\n   */\n  addFallbackParams(cam: any): any {\n    const paramFlashVars = document.createElement('param');\n    paramFlashVars.name = 'FlashVars';\n    paramFlashVars.value = 'mode=' + this.options.fallbackMode + '&amp;quality=' + this.options.fallbackQuality;\n    cam.appendChild(paramFlashVars);\n\n    const paramAllowScriptAccess = document.createElement('param');\n    paramAllowScriptAccess.name = 'allowScriptAccess';\n    paramAllowScriptAccess.value = 'always';\n    cam.appendChild(paramAllowScriptAccess);\n\n    // if (this.browser.appVersion.indexOf('MSIE') > -1) {\n    // if (isIE) {\n    cam.classid = 'clsid:D27CDB6E-AE6D-11cf-96B8-444553540000';\n    const paramMovie = document.createElement('param');\n    paramMovie.name = 'movie';\n    paramMovie.value = this.options.fallbackSrc;\n    cam.appendChild(paramMovie);\n    // } else {\n    cam.data = this.options.fallbackSrc;\n    // }\n  }\n\n  /**\n   * On web camera using flash fallback\n   * .swf file is necessary\n   * @returns {void}\n   */\n  onFallback(): any {\n    // Act as a plain getUserMedia shield if no fallback is required\n    if (this.options) {\n      // Fallback to flash\n      const self = this;\n      const cam = this.getVideoElm();\n      cam.width = self.options.width;\n      cam.height = self.options.height;\n\n      this.addFallbackParams(cam);\n\n      (function register(run) {\n        if (cam.capture !== undefined) {\n          self.onSuccess.emit(cam);\n        } else if (run === 0) {\n          self.onError.emit(new Error('Flash movie not yet registered!'));\n        } else {\n          // Flash interface not ready yet\n          window.setTimeout(register, 1000 * (4 - run), run - 1);\n        }\n      }(3));\n    }\n    else {\n      console.error('WebCam options is require');\n    }\n  }\n\n  /**\n   * Start capturing video stream\n   * @returns {void}\n   */\n  startCapturingVideo(): any {\n    if (!this.isFallback && this.isSupportWebRTC) {\n      return this.onWebRTC();\n    }\n\n    return this.processSuccess()\n  }\n\n  drawImageArrayToCanvas(imgArray){\n    const canvas = this.getCanvas();\n    //const di = this.getVideoDimensions()\n    const ctx = canvas.getContext('2d');\n    const width = imgArray[0].split(';').length\n    const height = imgArray.length\n    canvas.width = width\n    canvas.height = height\n    ctx.clearRect(0, 0, width, height);\n\n    const externData = {\n      imgData: ctx.getImageData(0, 0, width, height),\n      pos: 0\n    };\n\n    let tmp = null;\n    for(let x=0; x < imgArray.length; ++x){\n      let col = imgArray[x].split(';')\n      for (let i = 0; i < width; i++) {\n        tmp = parseInt(col[i], 10);\n        externData.imgData.data[externData.pos + 0] = (tmp >> 16) & 0xff;\n        externData.imgData.data[externData.pos + 1] = (tmp >> 8) & 0xff;\n        externData.imgData.data[externData.pos + 2] = tmp & 0xff;\n        externData.imgData.data[externData.pos + 3] = 0xff;\n        externData.pos += 4;\n      }\n\n      /*if (externData.pos >= 4 * width * height) {\n        ctx.putImageData(externData.imgData, 0, 0);\n        externData.pos = 0;\n      }*/\n    }\n\n    ctx.putImageData(externData.imgData, 0, 0);\n\n    return canvas\n  }\n  ngOnDestroy(){\n    this.observer.disconnect()\n    window.removeEventListener(this.onResize)\n\n    const vid = this.getVideoElm()\n\n    if(vid && vid.pause){\n      vid.pause()\n    }\n\n    if(this.stream){\n      this.stream.getTracks()[0].stop();\n    }\n  }\n\n  getCanvas(){\n    return document.createElement('canvas')\n  }\n\n  /** returns promise . @mime - null=png . Also accepts image/jpeg */\n  getBase64(mime?){\n    if(this.isFallback){\n      return this.getFallbackBase64(mime)\n    }else{\n      const canvas = this.getCanvas()\n      const video = this.getVideoElm()\n      this.setCanvasWidth(canvas, video)\n      canvas.getContext('2d').drawImage(video, 0, 0)\n      return Promise.resolve( canvas.toDataURL(mime) )\n    }\n  }\n\n  getFallbackBase64(mime?){\n    mime = mime || this.mime\n\n    return new Promise((res,rej)=>{\n      this.flashPlayer.onImage = img=>{\n        res(img)\n      }\n      this.getVideoElm().capture()\n    })\n    .then( (canvas:{toDataURL:Function})=>canvas.toDataURL(mime) )\n  }\n\n  setCanvasWidth(canvas?, video?){\n    const di = this.getVideoDimensions(video)\n    canvas = canvas || this.getCanvas()\n    canvas.width = di.width\n    canvas.height = di.height\n  }\n\n  /**\n   * Implement fallback external interface\n   */\n  setupFallback(): void {\n    this.isFallback = true\n    let dataImgArray = []\n\n    this.flashPlayer = window['webcam'] = {\n      onImage:()=>{},\n      debug: function(tag, message){\n        if(tag=='notify' && message=='Capturing finished.'){\n          this.flashPlayer.onImage( this.drawImageArrayToCanvas(dataImgArray) )\n        }\n      }.bind(this),\n      onCapture: function(){\n        dataImgArray.length = 0\n        this.getVideoElm().save();\n      }.bind(this),\n      onTick: (time) => {},\n      onSave: (data) => {\n        dataImgArray.push(data)\n      }\n    }\n  }\n\n  captureAsFormData(options?:{mime?:string, fileName?:string, form?:FormData}){\n    options = options || {}\n    return this.getBase64(options.mime)\n    .then( base64=>this.dataUriToFormData(base64, {fileName:options.fileName}) )\n  }\n  \n  dataUriToFormData(dataURI, options?:{fileName?:string, form?:FormData}){\n    options = options || {}\n    options.form = options.form || new FormData()\n    options.form.append('file', dataUriToBlob(dataURI), options.fileName||'file.jpg');\n    return options.form\n  }\nstatic decorators: DecoratorInvocation[] = [\n{ type: Component, args: [{\n  selector: 'ack-webcam',\n  template: template\n}, ] },\n];\n/** @nocollapse */\nstatic ctorParameters: () => ({type: any, decorators?: DecoratorInvocation[]}|null)[] = () => [\n{type: DomSanitizer, },\n{type: ElementRef, },\n];\nstatic propDecorators: {[key: string]: DecoratorInvocation[]} = {\n'mime': [{ type: Input },],\n'ref': [{ type: Input },],\n'refChange': [{ type: Output },],\n'options': [{ type: Input },],\n'onSuccess': [{ type: Output },],\n'onError': [{ type: Output },],\n};\n}\n\n\nexport function dataUriToBlob(dataURI) {\n  // convert base64/URLEncoded data component to raw binary data held in a string\n  var byteString;\n  if (dataURI.split(',')[0].indexOf('base64') >= 0){\n    byteString = atob(dataURI.split(',')[1]);\n  }else{\n    byteString = window['unescape'](dataURI.split(',')[1]);\n  }\n\n  // separate out the mime component\n  var mimeString = dataURI.split(',')[0].split(':')[1].split(';')[0];\n  // write the bytes of the string to a typed array\n  var ia = new Uint8Array(byteString.length);\n  for (var i = 0; i < byteString.length; i++) {\n      ia[i] = byteString.charCodeAt(i);\n  }\n  return new Blob([ia], {type:mimeString});\n}\n\ninterface DecoratorInvocation {\n  type: Function;\n  args?: any[];\n}\n"]}